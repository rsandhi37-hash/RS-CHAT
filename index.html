<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>RS Chat Secure</title>
    
    <!-- Meta Tags -->
    <meta property="og:title" content="RS Chat Secure">
    <meta property="og:description" content="Ultra-Secure Terminal by Rehan Sandhi">
    <meta property="og:image" content="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBi6ygCLdTKWe2P6CHvFgPIwTXOh82nyVHHT7IONvyAb5Cf_dVuvk98xw65ldgWvbsD5AUXtm2tEqeOmzD-mGwgWxbgZM52Iub4LyS4Y_zTWxy-U4T9ejM7sIH5BzUgjfyATc1qoyWm2l6pr2m0TVQG36nGGPDe6Pq4GwXM-Ne73sfRI7vwXL9hfRpsCXs/s16000/16471.jpg">
    <meta property="og:url" content="https://rsandhi37-hash.github.io/RS-CHAT/">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0d1117">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBi6ygCLdTKWe2P6CHvFgPIwTXOh82nyVHHT7IONvyAb5Cf_dVuvk98xw65ldgWvbsD5AUXtm2tEqeOmzD-mGwgWxbgZM52Iub4LyS4Y_zTWxy-U4T9ejM7sIH5BzUgjfyATc1qoyWm2l6pr2m0TVQG36nGGPDe6Pq4GwXM-Ne73sfRI7vwXL9hfRpsCXs/s192/16471.jpg">
    
    <!-- External CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Install Prompt -->
    <div id="installPrompt">
        <div class="install-card">
            <h2 style="color: #58a6ff;">üîê RS CHAT SECURE</h2>
            <p style="margin: 15px 0; color: #8b949e;">Install karein private chat ke liye</p>
            <button class="install-button" id="btnInstall">üì≤ INSTALL APP</button>
            <p style="margin-top: 15px; font-size: 12px; color: #6e7681;">Ya browser menu se "Add to Home Screen" karein</p>
        </div>
    </div>

    <!-- PIN Screen -->
    <div id="pinScreen">
        <div class="pin-container">
            <h3 style="text-align: center; margin-bottom: 15px; color: #58a6ff;">ENTER PIN</h3>
            <div class="pin-display" id="pinDisplay">‚óã‚óã‚óã‚óã</div>
            <div class="pin-keypad" id="keypad"></div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp">
        <div class="header">‚ö° RS CHAT // SECURE TERMINAL ‚ö°</div>
        <div id="display"></div>
        <div class="controls">
            <input type="text" id="userInput" placeholder="Type message here..." autocomplete="off">
            <div class="btn-group">
                <button class="action-btn dec-btn" id="decryptBtn">üîì DECODE</button>
                <button class="action-btn enc-btn" id="encryptBtn">üîí ENCRYPT & SEND</button>
            </div>
        </div>
    </div>

    <!-- External JavaScript -->
    <script src="script.js"></script>
</body>
</html>            display: flex; 
            flex-direction: column; 
            gap: 10px; 
        }
        
        .bubble { 
            max-width: 85%; 
            padding: 12px 15px; 
            border-radius: 18px; 
            font-size: 14px; 
            word-wrap: break-word; 
            line-height: 1.4;
        }
        
        .sent { 
            background: #238636; 
            align-self: flex-end; 
            border-bottom-right-radius: 4px;
        }
        
        .received { 
            background: #30363d; 
            align-self: flex-start; 
            border-bottom-left-radius: 4px;
        }
        
        .controls { 
            background: #161b22; 
            padding: 15px; 
            position: fixed; 
            bottom: 0; 
            width: 100%; 
            border-top: 1px solid #30363d; 
        }
        
        #userInput { 
            width: 100%; 
            padding: 15px; 
            background: #0d1117; 
            border: 1px solid #30363d; 
            border-radius: 25px; 
            color: #58a6ff; 
            margin-bottom: 12px; 
            outline: none; 
            font-size: 15px;
        }
        
        .btn-group { 
            display: flex; 
            gap: 12px; 
        }
        
        button.action-btn { 
            flex: 1; 
            padding: 14px; 
            border: none; 
            border-radius: 25px; 
            color: white; 
            font-weight: bold; 
            cursor: pointer; 
            font-size: 15px;
            transition: 0.2s;
        }
        
        button.action-btn:active {
            transform: scale(0.98);
            opacity: 0.9;
        }
        
        .dec-btn { 
            background: #1f6feb; 
        }
        
        .enc-btn { 
            background: #238636; 
        }
    </style>
</head>
<body>
    <!-- Install Prompt -->
    <div id="installPrompt">
        <div class="install-card">
            <h2 style="color: #58a6ff;">üîê RS CHAT SECURE</h2>
            <p style="margin: 15px 0; color: #8b949e;">Install karein private chat ke liye</p>
            <button class="install-button" id="btnInstall">üì≤ INSTALL APP</button>
            <p style="margin-top: 15px; font-size: 12px; color: #6e7681;">Ya browser menu se "Add to Home Screen" karein</p>
        </div>
    </div>

    <!-- PIN Screen -->
    <div id="pinScreen">
        <div class="pin-container">
            <h3 style="text-align: center; margin-bottom: 15px; color: #58a6ff;">ENTER PIN</h3>
            <div class="pin-display" id="pinDisplay">‚óã‚óã‚óã‚óã</div>
            <div class="pin-keypad" id="keypad"></div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp">
        <div class="header">‚ö° RS CHAT // SECURE TERMINAL ‚ö°</div>
        <div id="display"></div>
        <div class="controls">
            <input type="text" id="userInput" placeholder="Type message here..." autocomplete="off">
            <div class="btn-group">
                <button class="action-btn dec-btn" onclick="handleDecrypt()">üîì DECODE</button>
                <button class="action-btn enc-btn" onclick="handleEncrypt()">üîí ENCRYPT & SEND</button>
            </div>
        </div>
    </div>

    <script>
        // ========== CONFIGURATION ==========
        const APP_PIN = "1818";
        const MASTER_KEY = "REHAN_SANDHI_181";
        const syms = ["%", "$", "#", "@", "!", "+", "√ó", "√∑", "=", "?", ";", ":", "‚Ä¢", "~", "_", "/"];
        const separator = "¬ß";
        
        // ========== GLOBAL VARIABLES ==========
        let currentPin = "";
        let isUnlocked = false;
        let deferredPrompt;

        // ========== SERVICE WORKER ==========
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('SW registered!'))
                .catch(err => console.log('SW failed:', err));
        }

        // ========== PWA INSTALL ==========
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            if (!window.matchMedia('(display-mode: standalone)').matches && !window.navigator.standalone) {
                document.getElementById('installPrompt').style.display = 'flex';
            }
        });

        document.getElementById('btnInstall').addEventListener('click', async () => {
            if (!deferredPrompt) {
                alert('Browser menu se "Add to Home Screen" karein');
                return;
            }
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            if (outcome === 'accepted') {
                deferredPrompt = null;
                location.reload();
            }
        });

        // ========== PAGE LOAD ==========
        window.addEventListener('load', () => {
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
            
            if (isStandalone) {
                document.getElementById('installPrompt').style.display = 'none';
                document.getElementById('pinScreen').style.display = 'flex';
                renderKeypad();
            } else {
                document.getElementById('installPrompt').style.display = 'flex';
            }
        });

        // ========== PIN KEYPAD FUNCTIONS ==========
        function renderKeypad() {
            const pad = document.getElementById('keypad');
            if (!pad) return;
            
            pad.innerHTML = "";
            const keys = [1, 2, 3, 4, 5, 6, 7, 8, 9, 'DEL', 0, 'OK'];
            
            keys.forEach(value => {
                const btn = document.createElement('button');
                btn.className = 'pin-key';
                btn.textContent = value;
                
                if (value === 'DEL') btn.classList.add('del');
                if (value === 'OK') btn.classList.add('enter');
                
                btn.onclick = function() {
                    if (value === 'DEL') {
                        delPin();
                    } else if (value === 'OK') {
                        verifyPin();
                    } else {
                        addPin(value.toString());
                    }
                };
                
                pad.appendChild(btn);
            });
        }

        function addPin(v) {
            if (currentPin.length < 4) {
                currentPin += v;
                updatePinDisplay();
            }
        }

        function delPin() {
            currentPin = currentPin.slice(0, -1);
            updatePinDisplay();
        }

        function updatePinDisplay() {
            const display = document.getElementById('pinDisplay');
            if (display) {
                let dots = '';
                for(let i = 0; i < currentPin.length; i++) {
                    dots += '‚óè';
                }
                let circles = '';
                for(let i = 0; i < 4 - currentPin.length; i++) {
                    circles += '‚óã';
                }
                display.textContent = dots + circles;
            }
        }

        function verifyPin() {
            if (currentPin === APP_PIN) {
                isUnlocked = true;
                document.getElementById('pinScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'flex';
            } else {
                alert('‚ùå Wrong PIN! Try again.');
                currentPin = '';
                updatePinDisplay();
            }
        }

        // ========== ENCRYPTION FUNCTIONS ==========
        function getWeight() {
            let w = 0;
            for (let i = 0; i < MASTER_KEY.length; i++) {
                w += MASTER_KEY.charCodeAt(i);
            }
            return w;
        }

        function getSalt() {
            const d = new Date();
            return d.getHours() + Math.floor(d.getMinutes() / 10);
        }

        function handleEncrypt() {
            const text = document.getElementById('userInput').value.trim();
            if (!text) {
                alert('Please type a message!');
                return;
            }
            
            const salt = getSalt();
            const weight = getWeight();
            let encrypted = '';
            
            for (let i = 0; i < text.length; i++) {
                const charCode = text.charCodeAt(i);
                const hex = (charCode + salt + weight).toString(16);
                const randomSym1 = syms[Math.floor(Math.random() * syms.length)];
                const randomSym2 = syms[Math.floor(Math.random() * syms.length)];
                encrypted += randomSym1 + hex + randomSym2 + separator;
            }
            
            addBubble(text, 'sent');
            document.getElementById('userInput').value = '';
            
            navigator.clipboard.writeText(encrypted).then(() => {
                console.log('Copied to clipboard!');
            }).catch(() => {
                alert('Copy this: ' + encrypted);
            });
            
            window.open(`https://wa.me/?text=${encodeURIComponent(encrypted)}`, '_blank');
        }

        function handleDecrypt() {
            const input = document.getElementById('userInput').value.trim();
            if (!input) {
                alert('Please paste encrypted code!');
                return;
            }
            
            const salt = getSalt();
            const weight = getWeight();
            let decrypted = '';
            
            try {
                const segments = input.split(separator);
                segments.forEach(seg => {
                    const hexMatch = seg.match(/[0-9a-fA-F]+/);
                    if (hexMatch) {
                        const charCode = parseInt(hexMatch[0], 16) - salt - weight;
                        decrypted += String.fromCharCode(charCode);
                    }
                });
                
                if (decrypted) {
                    addBubble(decrypted, 'received');
                } else {
                    addBubble('[EMPTY MESSAGE]', 'received');
                }
            } catch (e) {
                alert('‚ùå Invalid encrypted code!');
            }
            
            document.getElementById('userInput').value = '';
        }

        function addBubble(text, type) {
            const display = document.getElementById('display');
            const bubble = document.createElement('div');
            bubble.className = `bubble ${type}`;
            bubble.textContent = text;
            display.appendChild(bubble);
            display.scrollTop = display.scrollHeight;
        }
    </script>
</body>
</html>            color: white; 
            padding: 15px; 
            font-size: 20px; 
            border-radius: 10px; 
            cursor: pointer; 
        }
        
        .pin-key:active { 
            background: #30363d; 
        }
        
        .pin-key.enter { 
            background: #238636; 
        }
        
        .pin-key.del { 
            background: #da3633; 
        }
        
        #mainApp { 
            display: none; 
            height: 100vh; 
            flex-direction: column; 
        }
        
        .header { 
            background: #161b22; 
            color: #58a6ff; 
            padding: 20px; 
            text-align: center; 
            font-weight: bold; 
            border-bottom: 1px solid #30363d; 
        }
        
        #display { 
            flex: 1; 
            overflow-y: auto; 
            padding: 20px 15px 160px; 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
        }
        
        .bubble { 
            max-width: 85%; 
            padding: 10px; 
            border-radius: 10px; 
            font-size: 14px; 
            word-wrap: break-word; 
        }
        
        .sent { 
            background: #238636; 
            align-self: flex-end; 
        }
        
        .received { 
            background: #30363d; 
            align-self: flex-start; 
        }
        
        .controls { 
            background: #161b22; 
            padding: 15px; 
            position: fixed; 
            bottom: 0; 
            width: 100%; 
            border-top: 1px solid #30363d; 
        }
        
        input { 
            width: 100%; 
            padding: 12px; 
            background: #0d1117; 
            border: 1px solid #30363d; 
            border-radius: 8px; 
            color: #58a6ff; 
            margin-bottom: 10px; 
            outline: none; 
        }
        
        .btn-group { 
            display: flex; 
            gap: 10px; 
        }
        
        button.action-btn { 
            flex: 1; 
            padding: 12px; 
            border: none; 
            border-radius: 8px; 
            color: white; 
            font-weight: bold; 
            cursor: pointer; 
        }
        
        .dec-btn { 
            background: #1f6feb; 
        }
        
        .enc-btn { 
            background: #238636; 
        }
    </style>
</head>
<body>
    <!-- Install Prompt -->
    <div id="installPrompt">
        <div class="install-card">
            <h2>üîê RS CHAT SECURE</h2>
            <p style="margin: 15px 0; color: #8b949e;">Install karein private chat ke liye</p>
            <button class="install-button" id="btnInstall">üì≤ INSTALL APP</button>
            <p style="margin-top: 15px; font-size: 12px; color: #6e7681;">Ya browser menu se "Add to Home Screen" karein</p>
        </div>
    </div>

    <!-- PIN Screen -->
    <div id="pinScreen">
        <div class="pin-container">
            <h3 style="text-align: center; margin-bottom: 15px; color: #58a6ff;">ENTER PIN</h3>
            <div class="pin-display" id="pinDisplay">‚óã‚óã‚óã‚óã</div>
            <div class="pin-keypad" id="keypad"></div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp">
        <div class="header">‚ö° RS CHAT // SECURE TERMINAL ‚ö°</div>
        <div id="display"></div>
        <div class="controls">
            <input type="text" id="userInput" placeholder="Type message here..." autocomplete="off">
            <div class="btn-group">
                <button class="action-btn dec-btn" onclick="handleDecrypt()">üîì DECODE</button>
                <button class="action-btn enc-btn" onclick="handleEncrypt()">üîí ENCRYPT & SEND</button>
            </div>
        </div>
    </div>

    <script>
        // ========== CONFIGURATION ==========
        const APP_PIN = "1818";
        const MASTER_KEY = "REHAN_SANDHI_181";
        const syms = ["%", "$", "#", "@", "!", "+", "√ó", "√∑", "=", "?", ";", ":", "‚Ä¢", "~", "_", "/"];
        const separator = "¬ß";
        
        // ========== GLOBAL VARIABLES ==========
        let currentPin = "";
        let isUnlocked = false;
        let deferredPrompt;

        // ========== SERVICE WORKER ==========
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('SW registered!'))
                .catch(err => console.log('SW failed:', err));
        }

        // ========== PWA INSTALL ==========
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Check if already installed
            if (!window.matchMedia('(display-mode: standalone)').matches && !window.navigator.standalone) {
                document.getElementById('installPrompt').style.display = 'flex';
            }
        });

        // Install button click
        document.getElementById('btnInstall').addEventListener('click', async () => {
            if (!deferredPrompt) {
                alert('Browser menu se "Add to Home Screen" karein');
                return;
            }
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            if (outcome === 'accepted') {
                deferredPrompt = null;
                location.reload();
            }
        });

        // ========== PAGE LOAD ==========
        window.addEventListener('load', () => {
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
            
            if (isStandalone) {
                // App installed mode
                document.getElementById('installPrompt').style.display = 'none';
                document.getElementById('pinScreen').style.display = 'flex';
                renderKeypad();
            } else {
                // Browser mode - show install prompt
                document.getElementById('installPrompt').style.display = 'flex';
            }
        });

        // ========== PIN KEYPAD FUNCTIONS ==========
        function renderKeypad() {
            const pad = document.getElementById('keypad');
            if (!pad) return;
            
            pad.innerHTML = "";
            const keys = [1, 2, 3, 4, 5, 6, 7, 8, 9, 'DEL', 0, 'OK'];
            
            keys.forEach(value => {
                const btn = document.createElement('button');
                btn.className = 'pin-key';
                btn.textContent = value;
                
                if (value === 'DEL') btn.classList.add('del');
                if (value === 'OK') btn.classList.add('enter');
                
                btn.onclick = function() {
                    if (value === 'DEL') delPin();
                    else if (value === 'OK') verifyPin();
                    else addPin(value.toString());
                };
                
                pad.appendChild(btn);
            });
        }

        function addPin(v) {
            if (currentPin.length < 4) {
                currentPin += v;
                updatePinDisplay();
            }
        }

        function delPin() {
            currentPin = currentPin.slice(0, -1);
            updatePinDisplay();
        }

        function updatePinDisplay() {
            const display = document.getElementById('pinDisplay');
            if (display) {
                let dots = '';
                for(let i = 0; i < currentPin.length; i++) {
                    dots += '‚óè';
                }
                let circles = '';
                for(let i = 0; i < 4 - currentPin.length; i++) {
                    circles += '‚óã';
                }
                display.textContent = dots + circles;
            }
        }

        function verifyPin() {
            if (currentPin === APP_PIN) {
                isUnlocked = true;
                document.getElementById('pinScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'flex';
            } else {
                alert('‚ùå Wrong PIN! Try again.');
                currentPin = '';
                updatePinDisplay();
            }
        }

        // ========== ENCRYPTION FUNCTIONS ==========
        function getWeight() {
            let w = 0;
            for (let i = 0; i < MASTER_KEY.length; i++) {
                w += MASTER_KEY.charCodeAt(i);
            }
            return w;
        }

        function getSalt() {
            const d = new Date();
            return d.getHours() + Math.floor(d.getMinutes() / 10);
        }

        function handleEncrypt() {
            const text = document.getElementById('userInput').value.trim();
            if (!text) return;
            
            const salt = getSalt();
            const weight = getWeight();
            let encrypted = '';
            
            for (let i = 0; i < text.length; i++) {
                const hex = (text.charCodeAt(i) + salt + weight).toString(16);
                encrypted += syms[Math.floor(Math.random() * syms.length)] + hex + 
                            syms[Math.floor(Math.random() * syms.length)] + separator;
            }
            
            // Add to chat
            addBubble(text, 'sent');
            document.getElementById('userInput').value = '';
            
            // Copy to clipboard
            navigator.clipboard.writeText(encrypted).then(() => {
                console.log('Copied!');
            }).catch(() => {
                alert('Copy this: ' + encrypted);
            });
            
            // Open WhatsApp
            window.open(`https://wa.me/?text=${encodeURIComponent(encrypted)}`, '_blank');
        }

        function handleDecrypt() {
            const input = document.getElementById('userInput').value.trim();
            if (!input) return;
            
            const salt = getSalt();
            const weight = getWeight();
            let decrypted = '';
            
            try {
                const segments = input.split(separator);
                segments.forEach(seg => {
                    const hexMatch = seg.match(/[0-9a-fA-F]+/);
                    if (hexMatch) {
                        const charCode = parseInt(hexMatch[0], 16) - salt - weight;
                        decrypted += String.fromCharCode(charCode);
                    }
                });
                
                addBubble(decrypted || '[EMPTY]', 'received');
            } catch (e) {
                alert('‚ùå Invalid encrypted code!');
            }
            
            document.getElementById('userInput').value = '';
        }

        function addBubble(text, type) {
            const display = document.getElementById('display');
            const bubble = document.createElement('div');
            bubble.className = `bubble ${type}`;
            bubble.textContent = text;
            display.appendChild(bubble);
            display.scrollTop = display.scrollHeight;
        }
    </script>
</body>
</html>        }

        function getWeight() {
            let w = 0;
            for (let i = 0; i < MASTER_KEY.length; i++) w += MASTER_KEY.charCodeAt(i);
            return w;
        }

        function getSalt() {
            const d = new Date();
            return d.getHours() + Math.floor(d.getMinutes() / 10);
        }

        function handleEncrypt() {
            const text = document.getElementById('userInput').value.trim();
            if (!text) return;
            const salt = getSalt(), weight = getWeight();
            let encrypted = '';
            for (let i = 0; i < text.length; i++) {
                const hex = (text.charCodeAt(i) + salt + weight).toString(16);
                encrypted += syms[Math.floor(Math.random() * syms.length)] + hex + syms[Math.floor(Math.random() * syms.length)] + separator;
            }
            addBubble(text, 'sent');
            document.getElementById('userInput').value = '';
            navigator.clipboard.writeText(encrypted);
            window.open(`https://wa.me/?text=${encodeURIComponent(encrypted)}`, '_blank');
        }

        function handleDecrypt() {
            const input = document.getElementById('userInput').value.trim();
            if (!input) return;
            const salt = getSalt(), weight = getWeight();
            let decrypted = '';
            try {
                input.split(separator).forEach(seg => {
                    const hexMatch = seg.match(/[0-9a-fA-F]+/);
                    if (hexMatch) decrypted += String.fromCharCode(parseInt(hexMatch[0], 16) - salt - weight);
                });
                addBubble(decrypted || '[EMPTY]', 'received');
            } catch (e) { alert('‚ùå Invalid code!'); }
            document.getElementById('userInput').value = '';
        }

        function addBubble(text, type) {
            const display = document.getElementById('display');
            const bubble = document.createElement('div');
            bubble.className = `bubble ${type}`;
            bubble.textContent = text;
            display.appendChild(bubble);
            display.scrollTop = display.scrollHeight;
        }
    </script>
</body>
</html>
            padding: 15px; 
            font-size: 20px; 
            border-radius: 10px; 
            cursor: pointer; 
        }
        
        .pin-key:active { 
            background: #30363d; 
        }
        
        .pin-key.enter { 
            background: #238636; 
        }
        
        .pin-key.del { 
            background: #da3633; 
        }
        
        #mainApp { 
            display: none; 
            height: 100vh; 
            flex-direction: column; 
        }
        
        .header { 
            background: #161b22; 
            color: #58a6ff; 
            padding: 20px; 
            text-align: center; 
            font-weight: bold; 
            border-bottom: 1px solid #30363d; 
        }
        
        #display { 
            flex: 1; 
            overflow-y: auto; 
            padding: 20px 15px 160px; 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
        }
        
        .bubble { 
            max-width: 85%; 
            padding: 10px; 
            border-radius: 10px; 
            font-size: 14px; 
            word-wrap: break-word; 
        }
        
        .sent { 
            background: #238636; 
            align-self: flex-end; 
        }
        
        .received { 
            background: #30363d; 
            align-self: flex-start; 
        }
        
        .controls { 
            background: #161b22; 
            padding: 15px; 
            position: fixed; 
            bottom: 0; 
            width: 100%; 
            border-top: 1px solid #30363d; 
        }
        
        input { 
            width: 100%; 
            padding: 12px; 
            background: #0d1117; 
            border: 1px solid #30363d; 
            border-radius: 8px; 
            color: #58a6ff; 
            margin-bottom: 10px; 
            outline: none; 
        }
        
        .btn-group { 
            display: flex; 
            gap: 10px; 
        }
        
        button.action-btn { 
            flex: 1; 
            padding: 12px; 
            border: none; 
            border-radius: 8px; 
            color: white; 
            font-weight: bold; 
            cursor: pointer; 
        }
        
        .dec-btn { 
            background: #1f6feb; 
        }
        
        .enc-btn { 
            background: #238636; 
        }
    </style>
</head>
<body>
    <!-- Install Prompt -->
    <div id="installPrompt">
        <div class="install-card">
            <h2>üîê RS CHAT SECURE</h2>
            <p style="margin: 15px 0; color: #8b949e;">Install karein private chat ke liye</p>
            <button class="install-button" id="btnInstall">üì≤ INSTALL APP</button>
            <p style="margin-top: 15px; font-size: 12px; color: #6e7681;">Ya browser menu se "Add to Home Screen" karein</p>
        </div>
    </div>

    <!-- PIN Screen -->
    <div id="pinScreen">
        <div class="pin-container">
            <h3 style="text-align: center; margin-bottom: 15px; color: #58a6ff;">ENTER PIN</h3>
            <div class="pin-display" id="pinDisplay">‚óã‚óã‚óã‚óã</div>
            <div class="pin-keypad" id="keypad"></div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp">
        <div class="header">‚ö° RS CHAT // SECURE TERMINAL ‚ö°</div>
        <div id="display"></div>
        <div class="controls">
            <input type="text" id="userInput" placeholder="Type message here..." autocomplete="off">
            <div class="btn-group">
                <button class="action-btn dec-btn" onclick="handleDecrypt()">üîì DECODE</button>
                <button class="action-btn enc-btn" onclick="handleEncrypt()">üîí ENCRYPT & SEND</button>
            </div>
        </div>
    </div>

    <script>
        // ========== CONFIGURATION ==========
        const APP_PIN = "1818";
        const MASTER_KEY = "REHAN_SANDHI_181";
        const syms = ["%", "$", "#", "@", "!", "+", "√ó", "√∑", "=", "?", ";", ":", "‚Ä¢", "~", "_", "/"];
        const separator = "¬ß";
        
        // ========== GLOBAL VARIABLES ==========
        let currentPin = "";
        let isUnlocked = false;
        let deferredPrompt;

        // ========== SERVICE WORKER ==========
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('SW registered!'))
                .catch(err => console.log('SW failed:', err));
        }

        // ========== PWA INSTALL ==========
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Check if already installed
            if (!window.matchMedia('(display-mode: standalone)').matches && !window.navigator.standalone) {
                document.getElementById('installPrompt').style.display = 'flex';
            }
        });

        // Install button click
        document.getElementById('btnInstall').addEventListener('click', async () => {
            if (!deferredPrompt) {
                alert('Browser menu se "Add to Home Screen" karein');
                return;
            }
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            if (outcome === 'accepted') {
                deferredPrompt = null;
                location.reload();
            }
        });

        // ========== PAGE LOAD ==========
        window.addEventListener('load', () => {
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
            
            if (isStandalone) {
                // App installed mode
                document.getElementById('installPrompt').style.display = 'none';
                document.getElementById('pinScreen').style.display = 'flex';
                renderKeypad();
            } else {
                // Browser mode - show install prompt
                document.getElementById('installPrompt').style.display = 'flex';
            }
        });

        // ========== PIN KEYPAD FUNCTIONS ==========
        function renderKeypad() {
            const pad = document.getElementById('keypad');
            if (!pad) return;
            
            pad.innerHTML = "";
            const keys = [1, 2, 3, 4, 5, 6, 7, 8, 9, 'DEL', 0, 'OK'];
            
            keys.forEach(value => {
                const btn = document.createElement('button');
                btn.className = 'pin-key';
                btn.textContent = value;
                
                if (value === 'DEL') btn.classList.add('del');
                if (value === 'OK') btn.classList.add('enter');
                
                btn.onclick = () => {
                    if (value === 'DEL') delPin();
                    else if (value === 'OK') verifyPin();
                    else addPin(value.toString());
                };
                
                pad.appendChild(btn);
            });
        }

        function addPin(v) {
            if (currentPin.length < 4) {
                currentPin += v;
                updatePinDisplay();
            }
        }

        function delPin() {
            currentPin = currentPin.slice(0, -1);
            updatePinDisplay();
        }

        function updatePinDisplay() {
            const display = document.getElementById('pinDisplay');
            if (display) {
                const dots = '‚óè'.repeat(currentPin.length);
                const circles = '‚óã'.repeat(4 - currentPin.length);
                display.textContent = dots + circles;
            }
        }

        function verifyPin() {
            if (currentPin === APP_PIN) {
                isUnlocked = true;
                document.getElementById('pinScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'flex';
            } else {
                alert('‚ùå Wrong PIN! Try again.');
                currentPin = '';
                updatePinDisplay();
            }
        }

        // ========== ENCRYPTION FUNCTIONS ==========
        function getWeight() {
            let w = 0;
            for (let i = 0; i < MASTER_KEY.length; i++) {
                w += MASTER_KEY.charCodeAt(i);
            }
            return w;
        }

        function getSalt() {
            const d = new Date();
            return d.getHours() + Math.floor(d.getMinutes() / 10);
        }

        function handleEncrypt() {
            const text = document.getElementById('userInput').value.trim();
            if (!text) return;
            
            const salt = getSalt();
            const weight = getWeight();
            let encrypted = '';
            
            for (let i = 0; i < text.length; i++) {
                const hex = (text.charCodeAt(i) + salt + weight).toString(16);
                encrypted += syms[Math.floor(Math.random() * syms.length)] + hex + 
                            syms[Math.floor(Math.random() * syms.length)] + separator;
            }
            
            // Add to chat
            addBubble(text, 'sent');
            document.getElementById('userInput').value = '';
            
            // Copy to clipboard
            navigator.clipboard.writeText(encrypted).then(() => {
                console.log('Copied!');
            }).catch(() => {
                alert('Copy this: ' + encrypted);
            });
            
            // Open WhatsApp
            window.open(`https://wa.me/?text=${encodeURIComponent(encrypted)}`, '_blank');
        }

        function handleDecrypt() {
            const input = document.getElementById('userInput').value.trim();
            if (!input) return;
            
            const salt = getSalt();
            const weight = getWeight();
            let decrypted = '';
            
            try {
                const segments = input.split(separator);
                segments.forEach(seg => {
                    const hexMatch = seg.match(/[0-9a-fA-F]+/);
                    if (hexMatch) {
                        const charCode = parseInt(hexMatch[0], 16) - salt - weight;
                        decrypted += String.fromCharCode(charCode);
                    }
                });
                
                addBubble(decrypted || '[EMPTY]', 'received');
            } catch (e) {
                alert('‚ùå Invalid encrypted code!');
            }
            
            document.getElementById('userInput').value = '';
        }

        function addBubble(text, type) {
            const display = document.getElementById('display');
            const bubble = document.createElement('div');
            bubble.className = `bubble ${type}`;
            bubble.textContent = text;
            display.appendChild(bubble);
            display.scrollTop = display.scrollHeight;
        }
    </script>
</body>
</html>            pad.appendChild(btn);
        });
    }

    function addPin(v) { 
        if(currentPin.length < 4) { 
            currentPin += v; 
            updatePinDisp(); 
        } 
    }

    function delPin() { 
        currentPin = currentPin.slice(0,-1); 
        updatePinDisp(); 
    }

    function updatePinDisp() { 
        document.getElementById('pinDisplay').innerText = "‚óè".repeat(currentPin.length) + "‚óã".repeat(4-currentPin.length); 
    }

    function verifyPin() {
        if(currentPin === APP_PIN) {
            isUnlocked = true;
            document.getElementById('pinScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'flex';
        } else { 
            alert("Wrong PIN!"); 
            currentPin = ""; 
            updatePinDisp(); 
        }
    }

    function getWeight() { 
        let w = 0; 
        for(let i=0; i<MASTER_KEY.length; i++) w += MASTER_KEY.charCodeAt(i); 
        return w; 
    }

    function getSalt() { 
        let d = new Date(); 
        return d.getHours() + Math.floor(d.getMinutes()/10); 
    }

    function handleEncrypt() {
        let text = document.getElementById('userInput').value;
        if(!text) return;
        let salt = getSalt(), weight = getWeight(), enc = "";
        for(let i=0; i<text.length; i++) {
            let hex = (text.charCodeAt(i) + salt + weight).toString(16);
            enc += syms[Math.floor(Math.random()*syms.length)] + hex + syms[Math.floor(Math.random()*syms.length)] + separator;
        }
        addBubble(text, 'sent');
        document.getElementById('userInput').value = "";
        navigator.clipboard.writeText(enc);
        window.open(`https://wa.me/?text=${encodeURIComponent(enc)}`, '_blank');
    }

    function handleDecrypt() {
        let input = document.getElementById('userInput').value;
        if(!input) return;
        let salt = getSalt(), weight = getWeight(), dec = "";
        try {
            input.split(separator).forEach(seg => {
                let hex = seg.match(/[0-9a-fA-F]+/);
                if(hex) dec += String.fromCharCode(parseInt(hex[0], 16) - salt - weight);
            });
            addBubble(dec || "Error", 'received');
        } catch(e) { alert("Invalid Code!"); }
        document.getElementById('userInput').value = "";
    }

    function addBubble(t, c) {
        let d = document.getElementById('display');
        let b = document.createElement('div');
        b.className = `bubble ${c}`;
        b.innerText = t;
        d.appendChild(b);
        d.scrollTop = d.scrollHeight;
    }
                            
</script>
</body>
</html>
            renderKeypad();
        } else {
            document.getElementById('installPrompt').style.display = 'flex';
        }
    });

    function renderKeypad() {
        const pad = document.getElementById('keypad');
        pad.innerHTML = "";
        [1,2,3,4,5,6,7,8,9,'DEL',0,'OK'].forEach(v => {
            let b = document.createElement('button');
            b.className = 'pin-key' + (v=='DEL'?' del':v=='OK'?' enter':'');
            b.innerText = v;
            b.onclick = () => v=='DEL'?delPin():v=='OK'?verifyPin():addPin(v);
            pad.appendChild(b);
        });
    }

    function addPin(v) { if(currentPin.length < 4) { currentPin += v; updatePinDisp(); } }
    function delPin() { currentPin = currentPin.slice(0,-1); updatePinDisp(); }
    function updatePinDisp() { document.getElementById('pinDisplay').innerText = "‚óè".repeat(currentPin.length) + "‚óã".repeat(4-currentPin.length); }

    function verifyPin() {
        if(currentPin === APP_PIN) {
            isUnlocked = true;
            document.getElementById('pinScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'flex';
        } else {
            alert("Wrong PIN!"); currentPin = ""; updatePinDisp();
        }
    }

    function getWeight() { let w = 0; for(let i=0; i<MASTER_KEY.length; i++) w += MASTER_KEY.charCodeAt(i); return w; }
    function getSalt() { let d = new Date(); return d.getHours() + Math.floor(d.getMinutes()/10); }

    function handleEncrypt() {
        let text = document.getElementById('userInput').value;
        if(!text) return;
        let salt = getSalt(), weight = getWeight(), enc = "";
        for(let i=0; i<text.length; i++) {
            let hex = (text.charCodeAt(i) + salt + weight).toString(16);
            enc += syms[Math.floor(Math.random()*syms.length)] + hex + syms[Math.floor(Math.random()*syms.length)] + separator;
        }
        addBubble(text, 'sent');
        document.getElementById('userInput').value = "";
        navigator.clipboard.writeText(enc);
        window.open(`https://wa.me/?text=${encodeURIComponent(enc)}`, '_blank');
    }

    function handleDecrypt() {
        let input = document.getElementById('userInput').value;
        if(!input) return;
        let salt = getSalt(), weight = getWeight(), dec = "";
        try {
            input.split(separator).forEach(seg => {
                let hex = seg.match(/[0-9a-fA-F]+/);
                if(hex) dec += String.fromCharCode(parseInt(hex[0], 16) - salt - weight);
            });
            addBubble(dec || "Error", 'received');
        } catch(e) { alert("Invalid Code!"); }
        document.getElementById('userInput').value = "";
    }

    function addBubble(t, c) {
        let d = document.getElementById('display');
        let b = document.createElement('div');
        b.className = `bubble ${c}`;
        b.innerText = t;
        d.appendChild(b);
        d.scrollTop = d.scrollHeight;
    }
</script>
</body>
</html>
            b.innerText = v;
            b.onclick = () => v=='DEL'?delPin():v=='OK'?verifyPin():addPin(v);
            pad.appendChild(b);
        });
    }

    function addPin(v) { if(currentPin.length < 4) { currentPin += v; updatePinDisp(); } }
    function delPin() { currentPin = currentPin.slice(0,-1); updatePinDisp(); }
    function updatePinDisp() { document.getElementById('pinDisplay').innerText = "‚óè".repeat(currentPin.length) + "‚óã".repeat(4-currentPin.length); }

    function verifyPin() {
        if(currentPin === APP_PIN) {
            isUnlocked = true;
            document.getElementById('pinScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'flex';
        } else {
            alert("Wrong PIN!"); currentPin = ""; updatePinDisp();
        }
    }

    function getWeight() { let w = 0; for(let i=0; i<MASTER_KEY.length; i++) w += MASTER_KEY.charCodeAt(i); return w; }
    function getSalt() { let d = new Date(); return d.getHours() + Math.floor(d.getMinutes()/10); }

    function handleEncrypt() {
        let text = document.getElementById('userInput').value;
        if(!text) return;
        let salt = getSalt(), weight = getWeight(), enc = "";
        for(let i=0; i<text.length; i++) {
            let hex = (text.charCodeAt(i) + salt + weight).toString(16);
            enc += syms[Math.floor(Math.random()*syms.length)] + hex + syms[Math.floor(Math.random()*syms.length)] + separator;
        }
        addBubble(text, 'sent');
        document.getElementById('userInput').value = "";
        navigator.clipboard.writeText(enc);
        window.open(`https://wa.me/?text=${encodeURIComponent(enc)}`, '_blank');
    }

    function handleDecrypt() {
        let input = document.getElementById('userInput').value;
        if(!input) return;
        let salt = getSalt(), weight = getWeight(), dec = "";
        try {
            input.split(separator).forEach(seg => {
                let hex = seg.match(/[0-9a-fA-F]+/);
                if(hex) dec += String.fromCharCode(parseInt(hex[0], 16) - salt - weight);
            });
            addBubble(dec || "Error", 'received');
        } catch(e) { alert("Invalid Code!"); }
        document.getElementById('userInput').value = "";
    }

    function addBubble(t, c) {
        let d = document.getElementById('display');
        let b = document.createElement('div');
        b.className = `bubble ${c}`;
        b.innerText = t;
        d.appendChild(b);
        d.scrollTop = d.scrollHeight;
    }
</script>
</body>
</html>
            renderKeypad();
        } else {
            document.getElementById('installPrompt').style.display = 'flex';
        }
    });

    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        // Button ko active karna
        document.getElementById('btnInstall').style.opacity = "1";
    });

    document.getElementById('btnInstall').addEventListener('click', async () => {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') {
                deferredPrompt = null;
                location.reload();
            }
        } else {
            alert("Browser ke 3-dots menu mein ja kar 'Install App' ya 'Add to Home Screen' par click karein.");
        }
    });

    // --- BAAQI FUNCTIONS (KEYPAD & ENCRYPTION) ---
    function renderKeypad() {
        const pad = document.getElementById('keypad');
        pad.innerHTML = "";
        [1,2,3,4,5,6,7,8,9,'DEL',0,'OK'].forEach(v => {
            let b = document.createElement('button');
            b.className = 'pin-key' + (v=='DEL'?' del':v=='OK'?' enter':'');
            b.innerText = v;
            b.onclick = () => v=='DEL'?delPin():v=='OK'?verifyPin():addPin(v);
            pad.appendChild(b);
        });
    }

    function addPin(v) { if(currentPin.length < 4) { currentPin += v; updatePinDisp(); } }
    function delPin() { currentPin = currentPin.slice(0,-1); updatePinDisp(); }
    function updatePinDisp() { document.getElementById('pinDisplay').innerText = "‚óè".repeat(currentPin.length) + "‚óã".repeat(4-currentPin.length); }

    function verifyPin() {
        if(currentPin === APP_PIN) {
            isUnlocked = true;
            document.getElementById('pinScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'flex';
        } else {
            alert("Wrong PIN!"); currentPin = ""; updatePinDisp();
        }
    }

    function getWeight() { let w = 0; for(let i=0; i<MASTER_KEY.length; i++) w += MASTER_KEY.charCodeAt(i); return w; }
    function getSalt() { let d = new Date(); return d.getHours() + Math.floor(d.getMinutes()/10); }

    function handleEncrypt() {
        let text = document.getElementById('userInput').value;
        if(!text) return;
        let salt = getSalt(), weight = getWeight(), enc = "";
        for(let i=0; i<text.length; i++) {
            let hex = (text.charCodeAt(i) + salt + weight).toString(16);
            enc += syms[Math.floor(Math.random()*syms.length)] + hex + syms[Math.floor(Math.random()*syms.length)] + separator;
        }
        addBubble(text, 'sent');
        document.getElementById('userInput').value = "";
        navigator.clipboard.writeText(enc);
        window.open(`https://wa.me/?text=${encodeURIComponent(enc)}`, '_blank');
    }

    function handleDecrypt() {
        let input = document.getElementById('userInput').value;
        if(!input) return;
        let salt = getSalt(), weight = getWeight(), dec = "";
        try {
            input.split(separator).forEach(seg => {
                let hex = seg.match(/[0-9a-fA-F]+/);
                if(hex) dec += String.fromCharCode(parseInt(hex[0], 16) - salt - weight);
            });
            addBubble(dec || "Error", 'received');
        } catch(e) { alert("Invalid Code!"); }
        document.getElementById('userInput').value = "";
    }

    function addBubble(t, c) {
        let d = document.getElementById('display');
        let b = document.createElement('div');
        b.className = `bubble ${c}`;
        b.innerText = t;
        d.appendChild(b);
        d.scrollTop = d.scrollHeight;
    }
</script>
</body>
</html>
